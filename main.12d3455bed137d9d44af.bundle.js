(()=>{"use strict";var t,e={433:(t,e,s)=>{var i,a=s(260),n=s.n(a);!function(t){t.BOOT="boot-scene",t.LOAD="load-scene",t.PLAY="play-scene",t.SHOP="shop-scene"}(i||(i={}));const o=i,r={BALL_RADIUS:20,BALL_START_POSITION:new(0,Phaser.Math.Vector2)(0,300),BALL_X_VELOCITY:4,PLATFORM_THICKNESS:15,PLATFORM_TINT:7829124,PLATFORM_HIT_MIDDLE_TINT:5635925,PLATFORM_HIT_EDGE_TINT:16742229,GRADIENT_COLUMN_DEFAULT_TINT:13555427,GRADIENT_COLUMN_RANDOM_TINTS:[13891810,14991865,16159937,15591345,11132665],PLATFORM_POOL_SIZE:10,PLATFORM_MIDDLE_PERCENTAGE:.6,HIGH_SCORE_STORAGE_KEY:"high-score",GEMS_COLLECTED_STORAGE_KEY:"gems-collected",SCREENSHAKE_DURATION:100,SCREENSHAKE_STRENGTH:.0075,GEM_SPAWN_CHANCE:.25};var h;!function(t){t.BALL="ball",t.SHOP_BALL="shop-ball",t.SHOP_CEILING="shop-ceiling",t.GEM="gem",t.PLATFORM_PARENT="platform-parent",t.PLATFORM_MIDDLE="platform-middle",t.PLATFORM_SIDE="platform-side"}(h||(h={}));const l=h;var c;!function(t){t[t.INIT=0]="INIT",t[t.MOVING=1]="MOVING",t[t.LOSE=2]="LOSE"}(c||(c={}));const p=c;class d{constructor(t,e,s){this.state=t,this.guid=e,this.callback=s}}const E=class{constructor(t){this.onEntryCallbacks=[],this.onExitCallbacks=[],this._currentState=t}get currentState(){return this._currentState}changeState(t){for(let t=0;t<this.onExitCallbacks.length;t++)this.onExitCallbacks[t].state===this._currentState&&this.onExitCallbacks[t].callback();for(let e=0;e<this.onEntryCallbacks.length;e++)this.onEntryCallbacks[e].state===t&&this.onEntryCallbacks[e].callback();this._currentState=t}configure(t){return this.configuringState=t,this}onEntry(t,e){return this.onEntryCallbacks.push(new d(this.configuringState,t,e)),this}onExit(t,e){return this.onExitCallbacks.push(new d(this.configuringState,t,e)),this}removeAllOf(t){this.onEntryCallbacks.filter((e=>e.guid===t)),this.onExitCallbacks.filter((e=>e.guid===t))}};var S;!function(t){t.SQUARE="square",t.GRADIENT="gradient",t.GEM="gem-sprite",t.BALL_DEFAULT="ball-default",t.BALL_HAPPY="ball-happy",t.BALL_CHIP="ball-chip",t.BALL_LEMON="ball-lemon",t.BALL_YINGYANG="ball-yingyang",t.BUTTON_IDLE="button-idle",t.BUTTON_CLICKED="button-clicked"}(S||(S={}));const g=S;var L;!function(t){t[t.BOOT=0]="BOOT",t[t.LOADING=1]="LOADING",t[t.PLAY=2]="PLAY",t[t.SHOP=3]="SHOP"}(L||(L={}));class u{}u.stateMachine=new E(L.BOOT),u.currentSkin=g.BALL_DEFAULT;class T{constructor(){this._eventCallbacks=[]}subscribe(t){this._eventCallbacks.push(t)}unsubscribe(t){this._eventCallbacks=this._eventCallbacks.filter((e=>e!==t))}invoke(){for(const t of this._eventCallbacks)t()}}class _{constructor(){this._eventCallbacks=[]}subscribe(t){this._eventCallbacks.push(t)}unsubscribe(t){this._eventCallbacks=this._eventCallbacks.filter((e=>e!==t))}invoke(t){for(const e of this._eventCallbacks)e(t)}}class m extends n().Physics.Matter.Sprite{constructor(t){var e;super(t.matter.world,-300,-100,u.currentSkin),this.hitCenter=new _,this.hitEdge=new T,this.scene.add.existing(this),this.playScene=t,this.type=l.BALL,this.setDisplaySize(2*r.BALL_RADIUS,2*r.BALL_RADIUS),this.setCircle(r.BALL_RADIUS),this.setMass(1),this.setFriction(0,0,0),this.setStatic(!0),this.playScene.matter.world.on(n().Physics.Matter.Events.COLLISION_START,((t,e,s)=>{if(!s.gameObject||s.gameObject.type!==l.PLATFORM_MIDDLE&&s.gameObject.type!==l.PLATFORM_SIDE)s.gameObject&&s.gameObject.type===l.GEM?(this.playScene.collectedGems++,s.gameObject.platformParent.collectGem()):(this.playScene.stateMachine.changeState(p.LOSE),this.playScene.matter.world.setBounds(0,0,0,0));else{this.velocityTween&&this.velocityTween.stop();const t=s.gameObject,e=t.platformParent.index;if(this.playScene.platformSpawner.touchedPlatformIndex.invoke(e),s.gameObject.type===l.PLATFORM_MIDDLE){const e=n().Math.RND.pick(r.GRADIENT_COLUMN_RANDOM_TINTS);this.playScene.addScore(2),this.hitCenter.invoke(e),t.glow(r.PLATFORM_HIT_MIDDLE_TINT)}else this.playScene.addScore(1),this.hitEdge.invoke(),t.glow(r.PLATFORM_HIT_EDGE_TINT);t.platformParent.removeBody(),this.playScene.time.addEvent({delay:5,callback:()=>{this.setVelocity(r.BALL_X_VELOCITY,-7),this.setAngularVelocity(.2)}})}})),this.playScene.input.on(n().Input.Events.POINTER_DOWN,(()=>this.thrustDown()));const s=null===(e=this.playScene.input.keyboard)||void 0===e?void 0:e.addKey(n().Input.Keyboard.KeyCodes.SPACE);null==s||s.on(n().Input.Keyboard.Events.DOWN,(()=>this.thrustDown())),this.playScene.stateMachine.configure(p.MOVING).onEntry(-1,(()=>{this.setStatic(!1)})),this.playScene.isWelcomingPlayer?this.setPosition(r.BALL_START_POSITION.x,r.BALL_START_POSITION.y):this.playScene.tweens.add({targets:this,x:r.BALL_START_POSITION.x,y:r.BALL_START_POSITION.y,duration:700,delay:1e3,ease:n().Math.Easing.Sine.Out})}thrustDown(){this.velocityTween&&this.velocityTween.stop(),this.velocityTween=this.playScene.tweens.addCounter({from:this.getVelocity().y,to:12,ease:"expo.out",duration:1e3,onUpdate:t=>{this.setVelocityY(t.getValue())}})}}const O=m;class I extends n().Physics.Matter.Image{constructor(t,e,s){switch(super(t.matter.world,0,0,g.SQUARE),this.scene.add.existing(this),this.platformParent=e,this.platformChildType=s,s){case A.LEFT:case A.RIGHT:this.type=l.PLATFORM_SIDE;break;case A.MIDDLE:this.type=l.PLATFORM_MIDDLE}this.setPosition(-1e4,0)}setup(t,e,s){switch(this.setTint(r.PLATFORM_TINT),this.platformChildType){case A.LEFT:this.setDisplaySize(s*(1-r.PLATFORM_MIDDLE_PERCENTAGE)/2,r.PLATFORM_THICKNESS),this.setRectangle(s*(1-r.PLATFORM_MIDDLE_PERCENTAGE)/2,r.PLATFORM_THICKNESS,{isStatic:!0}),this.setPosition(t-s*(.5-(1-r.PLATFORM_MIDDLE_PERCENTAGE)/4),e);break;case A.RIGHT:this.setDisplaySize(s*(1-r.PLATFORM_MIDDLE_PERCENTAGE)/2,r.PLATFORM_THICKNESS),this.setRectangle(s*(1-r.PLATFORM_MIDDLE_PERCENTAGE)/2,r.PLATFORM_THICKNESS,{isStatic:!0}),this.setPosition(t+s*(.5-(1-r.PLATFORM_MIDDLE_PERCENTAGE)/4),e);break;case A.MIDDLE:this.setDisplaySize(s*(r.PLATFORM_MIDDLE_PERCENTAGE+.01),r.PLATFORM_THICKNESS),this.setRectangle(s*(r.PLATFORM_MIDDLE_PERCENTAGE+.01),r.PLATFORM_THICKNESS,{isStatic:!0}),this.setPosition(t,e)}}glow(t){this.setTint(t)}}var A;!function(t){t[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT",t[t.MIDDLE=2]="MIDDLE"}(A||(A={}));class P extends n().Physics.Matter.Image{constructor(t,e,s=!0){super(t.matter.world,-100,-100,g.GEM),this.scene.add.existing(this),this.platformParent=e,this.type=l.GEM,this.setDisplaySize(25,25),this.setCircle(10),this.setStatic(s),this.setSensor(s)}}const y=P;class C extends n().GameObjects.GameObject{constructor(t){super(t,l.PLATFORM_PARENT),this.scene.add.existing(this),this.playScene=t,this.gradientColumn=t.add.image(0,0,g.GRADIENT),this.gradientColumn.setOrigin(.5,0),this.gradientColumn.setDepth(-1),this.platformLeft=new I(t,this,A.LEFT),this.platformRight=new I(t,this,A.RIGHT),this.platformMiddle=new I(t,this,A.MIDDLE),this.gem=new y(this.playScene,this),this.playScene.ball.hitCenter.subscribe((t=>this.handleBallHitCenter(t))),this.playScene.ball.hitEdge.subscribe((()=>this.handleBallHitEdge()))}setup(t,e,s){this.gradientColumn.setPosition(t,e),this.gradientColumn.setDisplaySize(s,800-e),this.gradientColumn.setTint(r.GRADIENT_COLUMN_DEFAULT_TINT),this.platformLeft.setup(t,e,s),this.platformRight.setup(t,e,s),this.platformMiddle.setup(t,e,s),Math.random()<r.GEM_SPAWN_CHANCE?this.gem.setPosition(t,e-25):this.gem.setPosition(0,-100)}removeBody(){this.playScene.matter.world.remove(this.platformLeft.body),this.playScene.matter.world.remove(this.platformRight.body),this.playScene.matter.world.remove(this.platformMiddle.body),this.playScene.tweens.add({targets:[this.platformLeft,this.platformMiddle,this.platformRight,this.gradientColumn],y:1200,duration:400,ease:"Linear"})}collectGem(){this.gem.setPosition(0,-100)}handleBallHitCenter(t){this.gradientColumn.setTint(t)}handleBallHitEdge(){this.gradientColumn.setTint(r.GRADIENT_COLUMN_DEFAULT_TINT)}}const M=C;var R=n().Display.Color;class D extends n().GameObjects.Text{constructor(t){super(t,0,100,"0",{font:"150px calibri",color:"#eeeeee"}),this.scene.add.existing(this),this.playScene=t,this.setOrigin(.5,0),this.setDepth(-1),this.playScene.scoreChanged.subscribe((t=>this.text=t.toString())),this.playScene.stateMachine.configure(p.MOVING).onEntry(-1,(()=>{this.setX(this.scene.scale.width/2),this.setScrollFactor(0)})),this.playScene.stateMachine.configure(p.MOVING).onExit(-1,(()=>{this.setScrollFactor(1),this.setX(this.scene.cameras.main.scrollX+this.scene.scale.width/2)})),this.playScene.stateMachine.configure(p.LOSE).onEntry(-1,(()=>{this.playScene.tweens.addCounter({from:0,to:100,duration:300,ease:n().Math.Easing.Sine.Out,onUpdate:t=>{const e=n().Display.Color.Interpolate.ColorWithColor(R.IntegerToColor(15658734),R.IntegerToColor(4473924),100,t.getValue());this.setColor(R.ObjectToColor(e).rgba)}})}))}}const f=D;var b=n().Input.Events.GAMEOBJECT_POINTER_OUT,N=n().Input.Events.GAMEOBJECT_POINTER_OVER,x=n().Input.Events.GAMEOBJECT_POINTER_DOWN,G=n().Input.Events.GAMEOBJECT_POINTER_UP;class B extends n().GameObjects.NineSlice{constructor(t,e=g.BUTTON_IDLE,s=g.BUTTON_IDLE,i=g.BUTTON_CLICKED){super(t,0,0,e,0,512,256,128,128),this.scene.add.existing(this),this.on(b,(()=>this.setTexture(e))),s&&this.on(N,(()=>this.setTexture(s))),s&&this.on(G,(()=>this.setTexture(s))),i&&this.on(x,(()=>this.setTexture(i))),this.setInteractive(),this.setScrollFactor(0),this.setTexture(e),this.setSize(1e3,10),this.setScale(.1),this.setTint(r.PLATFORM_TINT),this.text=t.add.text(this.x,this.y,"text"),this.text.setOrigin(.5),this.text.setColor("#ffffff"),this.text.setDepth(1e3),this.text.setScrollFactor(0),this.text.setFont("25px calibri")}setPosition(t,e,s,i){var a;return null===(a=this.text)||void 0===a||a.setPosition(t,e),super.setPosition(t,e,s,i)}setVisible(t){var e;return null===(e=this.text)||void 0===e||e.setVisible(t),super.setVisible(t)}}const w=B;var v=Phaser.Input.Events.GAMEOBJECT_POINTER_UP;const H=class extends w{constructor(t){super(t,g.BUTTON_IDLE,g.BUTTON_IDLE,g.BUTTON_CLICKED),this.playScene=t,this.setPosition(70,40),this.setDepth(100),this.setSize(700,10),this.setScale(.15),this.on(v,(()=>{this.playScene.visitShop()})),this.text.text="Shop"}};var F=n().Display.Color;class U extends n().GameObjects.Rectangle{constructor(t){super(t,-100,-100,t.scale.width+200,t.scale.height+200,16777215),this.scene.add.existing(this),this.playScene=t,this.setOrigin(0),this.setScrollFactor(0),this.setDepth(-100)}flashColor(t){this.playScene.tweens.addCounter({from:0,to:100,duration:200,ease:n().Math.Easing.Sine.InOut,onUpdate:e=>{const s=n().Display.Color.Interpolate.ColorWithColor(F.IntegerToColor(t),F.IntegerToColor(16777215),100,e.getValue());this.setFillStyle(n().Display.Color.GetColor(s.r,s.g,s.b))}})}}const k=U,K=class extends w{constructor(t){super(t),this.setPosition(t.scale.width/2,t.scale.height/2),this.text.text="Restart",this.setDepth(100),this.setSize(700,10),this.setScale(.15),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,(()=>{t.isWelcomingPlayer=!0,u.stateMachine.changeState(L.PLAY)}))}};var Y=n().Display.Color;class j extends n().GameObjects.Text{constructor(t){super(t,t.scale.width/2,250,"0",{font:"100px calibri",color:"#eeeeee"}),this.scene.add.existing(this),this.playScene=t,this.setOrigin(.5,0),this.setDepth(-1),this.setVisible(!1),this.setScrollFactor(1),this.playScene.stateMachine.configure(p.LOSE).onEntry(-1,(()=>{this.setVisible(!0),this.setX(this.scene.cameras.main.scrollX+this.scene.scale.width/2),this.text=localStorage.getItem(r.HIGH_SCORE_STORAGE_KEY),this.playScene.tweens.addCounter({from:0,to:100,duration:300,ease:n().Math.Easing.Sine.Out,onUpdate:t=>{const e=n().Display.Color.Interpolate.ColorWithColor(Y.IntegerToColor(16777215),Y.IntegerToColor(4473924),100,t.getValue());this.setColor(Y.ObjectToColor(e).rgba)}})}))}}const V=j;var W=n().Math.Vector2,X=n().Input.Events.POINTER_UP;class z extends n().Scene{constructor(){super({key:o.PLAY}),this.currentScore=-2,this.collectedGems=0,this.isWelcomingPlayer=!0,this.startedPlaying=!1,u.stateMachine.configure(L.PLAY).onEntry(-1,(()=>{u.sceneManager.start(o.PLAY)})),u.stateMachine.configure(L.PLAY).onExit(-1,(()=>{u.sceneManager.stop(this),this.isWelcomingPlayer=!1}))}create(){var t;this.startedPlaying=!1,this.stateMachine=new E(p.INIT),this.scoreChanged=new _,this.currentScore=-2,this.collectedGems=0,this.ball=new O(this),this.platformSpawner=new class{constructor(t){this.touchedPlatformIndex=new _,this.platforms=[],this.currentPlatformIndex=0,this.farthestPlatformXPosition=-1,this.currentWidth=75,this.currentHeight=600,this.playScene=t;for(let e=0;e<r.PLATFORM_POOL_SIZE;e++){const s=new M(t);s.setup(1,-1e4,0),s.index=e,this.platforms.push(s)}this.placeNextPlatform(),this.placeNextPlatform(),this.placeNextPlatform(),this.placeNextPlatform(),this.placeNextPlatform(),this.touchedPlatformIndex.subscribe((t=>{const e=(t-2+r.PLATFORM_POOL_SIZE)%r.PLATFORM_POOL_SIZE;for(;this.currentPlatformIndex!=e;)this.placeNextPlatform();this.currentWidth=Math.max(.975*this.currentWidth,20)})),this.easePlatformHeight()}placeNextPlatform(){this.currentPlatformIndex=(this.currentPlatformIndex+1)%r.PLATFORM_POOL_SIZE;const t=this.platforms[this.currentPlatformIndex];let e=this.farthestPlatformXPosition+200+Phaser.Math.Between(-50,50);-1===this.farthestPlatformXPosition&&(e=0),t.setup(e,this.currentHeight,this.currentWidth),this.farthestPlatformXPosition=e}easePlatformHeight(){this.playScene.tweens.addCounter({from:this.currentHeight,to:200*Math.random()+400,ease:"Sine.inout",duration:500*(5*Math.random()+10),onUpdate:t=>{this.currentHeight=t.getValue()},onComplete:()=>this.easePlatformHeight()})}}(this),this.scoreText=new f(this),this.highScoreText=new V(this),this.background=new k(this),this.visitShopButton=new H(this),this.restartButton=new K(this),this.restartButton.setVisible(!1),this.matter.world.setBounds(0,0,1e5,this.scale.height,64,!1,!1,!1),this.cameras.main.scrollX=-1e3,this.isWelcomingPlayer?(this.cameras.main.startFollow(this.ball,!1,.9,0),this.isWelcomingPlayer=!1):this.cameras.main.startFollow(this.ball,!1,.9,0),this.cameras.main.setBounds(-1e3,0,1e5,0),this.input.on(X,(()=>this.startPlay()));const e=null===(t=this.input.keyboard)||void 0===t?void 0:t.addKey(n().Input.Keyboard.KeyCodes.SPACE);null==e||e.on(n().Input.Keyboard.Events.DOWN,(()=>this.startPlay())),this.stateMachine.configure(p.INIT).onExit(-1,(()=>{this.visitShopButton.setVisible(!1)})),this.stateMachine.configure(p.MOVING).onEntry(-1,(()=>{this.tweens.add({targets:this.cameras.main.followOffset,x:-100,duration:400,ease:"Sine.out"})})),this.stateMachine.configure(p.MOVING).onExit(-1,this.handleLoseEntry.bind(this)),this.stateMachine.configure(p.LOSE).onEntry(-1,(()=>{this.restartButton.setVisible(!0)})),this.stateMachine.configure(p.LOSE).onExit(-1,(()=>{this.restartButton.setVisible(!1)})),this.handleGemsCollected(),this.handleHighScore()}addScore(t){this.currentScore+=t,this.cameras.main.shake(r.SCREENSHAKE_DURATION,new W(0,r.SCREENSHAKE_STRENGTH)),this.scoreChanged.invoke(this.currentScore)}visitShop(){this.cameras.main.stopFollow(),this.cameras.main.pan(-1e3+this.cameras.main.scrollX,this.scale.height/2,1e3,n().Math.Easing.Sine.InOut,!1,((t,e)=>{1===e&&u.stateMachine.changeState(L.SHOP)}))}handleLoseEntry(){this.cameras.main.stopFollow(),this.handleHighScore(),this.handleGemsCollected(),console.log("Lose")}handleHighScore(){localStorage.getItem(r.HIGH_SCORE_STORAGE_KEY)||localStorage.setItem(r.HIGH_SCORE_STORAGE_KEY,"0");const t=parseInt(localStorage.getItem(r.HIGH_SCORE_STORAGE_KEY));this.currentScore>t&&localStorage.setItem(r.HIGH_SCORE_STORAGE_KEY,this.currentScore.toString()),console.log("Highscore: "+localStorage.getItem(r.HIGH_SCORE_STORAGE_KEY))}handleGemsCollected(){"NaN"===localStorage.getItem(r.GEMS_COLLECTED_STORAGE_KEY)&&localStorage.setItem(r.GEMS_COLLECTED_STORAGE_KEY,"0");const t=parseInt(localStorage.getItem(r.GEMS_COLLECTED_STORAGE_KEY));localStorage.setItem(r.GEMS_COLLECTED_STORAGE_KEY,(t+this.collectedGems).toString()),console.log("Gems collected: "+localStorage.getItem(r.GEMS_COLLECTED_STORAGE_KEY))}startPlay(){this.startedPlaying||(this.stateMachine.changeState(p.MOVING),this.startedPlaying=!0)}}const J=z,Z={[g.SQUARE]:"./assets/images/Square.png",[g.GRADIENT]:"./assets/images/Gradient.png",[g.BALL_DEFAULT]:"./assets/images/Ball_Default.png",[g.BALL_HAPPY]:"./assets/images/Ball_happy.png",[g.BALL_CHIP]:"./assets/images/Ball_chip.png",[g.BALL_LEMON]:"./assets/images/Ball_lemon.png",[g.BALL_YINGYANG]:"./assets/images/Ball_yingyang.png",[g.BUTTON_IDLE]:"./assets/images/Button_idle.png",[g.BUTTON_CLICKED]:"./assets/images/Button_clicked.png",[g.GEM]:"./assets/images/Gem.png"},Q=class{static preloadSprite(t,e){t.load.image(e,Z[e])}};class q extends a.Scene{constructor(){super({key:o.LOAD}),u.stateMachine.configure(L.LOADING).onEntry(-1,(()=>u.sceneManager.start(o.LOAD)))}preload(){this.loadAssets(),this.showLoadingProgress()}create(){this.exitLoading()}exitLoading(){this.tweens.add({targets:this.ballImage,y:r.BALL_START_POSITION.y,displayHeight:2*r.BALL_RADIUS,displayWidth:2*r.BALL_RADIUS,duration:500,ease:"Sine.inout",onComplete:()=>{u.stateMachine.changeState(L.PLAY),this.ballImage.destroy()}}),this.tweens.add({targets:this.progressBar,alpha:0,duration:200,ease:"Sine.inout",onComplete:()=>{this.progressBar.destroy()}})}loadAssets(){Q.preloadSprite(this,g.SQUARE),Q.preloadSprite(this,g.GRADIENT),Q.preloadSprite(this,g.GEM),Q.preloadSprite(this,g.BALL_DEFAULT),Q.preloadSprite(this,g.BALL_HAPPY),Q.preloadSprite(this,g.BALL_CHIP),Q.preloadSprite(this,g.BALL_LEMON),Q.preloadSprite(this,g.BALL_YINGYANG),Q.preloadSprite(this,g.BUTTON_IDLE),Q.preloadSprite(this,g.BUTTON_CLICKED)}showLoadingProgress(){this.progressBar=this.add.graphics(),this.ballImage=this.add.image(this.scale.width/2,this.scale.height/2,g.BALL_DEFAULT),this.ballImage.scale=.25,this.load.on(Phaser.Loader.Events.PROGRESS,(t=>{this.progressBar.clear(),this.progressBar.fillStyle(3355443,1),this.progressBar.fillRect(this.scale.width/2-30,this.scale.height/2+60,60*t,5),this.ballImage.setRotation(t*Phaser.Math.PI2*2)}))}}const $=q;class tt extends a.Scene{constructor(){super({key:o.BOOT})}preload(){Q.preloadSprite(this,g.BALL_DEFAULT)}create(){this.tweens.setFps(60),u.sceneManager=this.scene,u.stateMachine.configure(L.BOOT).onExit(-1,(()=>u.sceneManager.stop(this))),u.stateMachine.changeState(L.LOADING)}}const et=tt;var st=n().Input.Events.GAMEOBJECT_POINTER_UP;class it extends n().Physics.Matter.Sprite{constructor(t,e,s){super(t.matter.world,100,200,e),this.isPurchased=!1,this.shopScene=t,this.shopScene.add.existing(this),this.spriteKey=e,this.type=l.SHOP_BALL,localStorage.getItem(this.spriteKey)||localStorage.setItem(this.spriteKey,"no"),this.isPurchased="yes"===localStorage.getItem(this.spriteKey),this.price=s,s<0&&(this.isPurchased=!0),this.setDisplaySize(2*r.BALL_RADIUS,2*r.BALL_RADIUS),this.setCircle(r.BALL_RADIUS),this.setStatic(!this.isPurchased),this.isPurchased?this.releaseBall():(this.priceText=this.shopScene.add.text(this.x,this.y+50,this.price.toString()),this.priceText.setColor("222222"),this.priceText.setOrigin(.5)),this.setInteractive(),this.on(st,(()=>{!this.isPurchased&&parseInt(localStorage.getItem(r.GEMS_COLLECTED_STORAGE_KEY))>=this.price&&this.purchase()}))}purchase(){this.isPurchased=!0,localStorage.setItem(this.spriteKey,"yes"),this.releaseBall(),this.priceText&&this.priceText.destroy();const t=parseInt(localStorage.getItem(r.GEMS_COLLECTED_STORAGE_KEY))-this.price;localStorage.setItem(r.GEMS_COLLECTED_STORAGE_KEY,t.toString()),this.shopScene.updateGemCount(t)}releaseBall(){this.setStatic(!1),this.setVelocity(n().Math.Between(-1,1),n().Math.Between(-3,-5)),this.setAngularVelocity(n().Math.Between(-.5,.5))}alignText(){this.isPurchased||this.priceText.setPosition(this.x,this.y+50)}}const at=it;class nt extends n().Physics.Matter.Image{constructor(t){super(t.matter.world,t.scale.width/2,-100,""),this.shopScene=t,this.shopScene.add.existing(this),this.type=l.SHOP_CEILING,this.setRectangle(this.shopScene.scale.width,100),this.setSensor(!0),this.setStatic(!0)}}const ot=nt;class rt extends n().Scene{constructor(){super({key:o.SHOP}),this.shopItems=[],this.gems=[],u.stateMachine.configure(L.SHOP).onEntry(-1,(()=>u.sceneManager.start(o.SHOP))),u.stateMachine.configure(L.SHOP).onExit(-1,(()=>u.sceneManager.stop(this)))}create(){this.matter.world.setBounds(0,0,this.scale.width,this.scale.height,64,!0,!0,!1,!0),new ot(this),this.shopItems=[],this.shopItems.push(new at(this,g.BALL_DEFAULT,-1)),this.shopItems.push(new at(this,g.BALL_HAPPY,3)),this.shopItems.push(new at(this,g.BALL_CHIP,3)),this.shopItems.push(new at(this,g.BALL_LEMON,3)),this.shopItems.push(new at(this,g.BALL_YINGYANG,3)),n().Actions.GridAlign(this.shopItems,{width:-1,height:0,cellWidth:75,cellHeight:75,x:-50,y:300}),this.shopItems.forEach((t=>t.alignText())),this.matter.add.mouseSpring(),this.matter.world.on(n().Physics.Matter.Events.COLLISION_START,((t,e,s)=>{e.gameObject&&s.gameObject&&(e.gameObject.type===l.SHOP_BALL&&(s.gameObject.type===l.SHOP_CEILING||s.gameObject.type===l.GEM)||e.gameObject.type===l.SHOP_CEILING&&(s.gameObject.type===l.SHOP_BALL||s.gameObject.type===l.GEM))&&(e.gameObject.type===l.SHOP_BALL?u.currentSkin=e.gameObject.spriteKey:u.currentSkin=s.gameObject.spriteKey,this.cameras.main.pan(1e3+this.cameras.main.scrollX,this.scale.height/2,1e3,n().Math.Easing.Sine.InOut,!1,((t,e)=>{1===e&&u.stateMachine.changeState(L.PLAY)})))})),this.gemCountText=this.add.text(this.scale.width/2,this.scale.height/2,localStorage.getItem(r.GEMS_COLLECTED_STORAGE_KEY)),this.gemCountText.setColor("#eeeeee"),this.gemCountText.setFont("100px calibri"),this.gemCountText.setOrigin(.5),this.gemCountText.setDepth(-100);const t=[],e=this.matter.world.nextGroup(!0);let s=0,i=this.matter.add.image(s,600,g.BALL_DEFAULT,void 0,{shape:"circle",mass:.1,circleRadius:2});i.setDisplaySize(2*r.BALL_RADIUS,2*r.BALL_RADIUS),t.push(i);for(var a=0;a<15;a++){var o=this.matter.add.image(s,600,g.BALL_DEFAULT,void 0,{shape:"circle",mass:.1,circleRadius:2,collisionFilter:{group:e}});t.push(o),this.matter.add.joint(i.body,o.body,25,.8),i=o,i.setDisplaySize(2*r.BALL_RADIUS,2*r.BALL_RADIUS),s+=30}i.setDisplaySize(2*r.BALL_RADIUS,2*r.BALL_RADIUS),this.matter.add.worldConstraint(t[0].body,2,.9,{pointA:{x:0,y:50},pointB:{x:-25,y:0}}),this.matter.add.worldConstraint(t[t.length-1].body,2,.9,{pointA:{x:this.scale.width,y:50},pointB:{x:25,y:0}});const h=parseInt(localStorage.getItem(r.GEMS_COLLECTED_STORAGE_KEY));for(let t=0;t<h;t++){const t=new y(this,void 0,!1);t.setPosition(n().Math.Between(0,this.scale.width),0),this.gems.push(t)}this.gemCountText.text=h.toString()}updateGemCount(t){this.gemCountText&&(this.gemCountText.text=t.toString());for(let e=this.gems.length-1;e>=t;e--)this.gems.pop().destroy()}}const ht={title:"Bouncing Ball 2",width:450,height:800,parent:"game",scene:[et,$,J,rt],backgroundColor:16777215,physics:{default:"matter",matter:{debug:!1,gravity:{x:0,y:.4}}}};class lt extends n().Game{constructor(t){super(t)}}window.addEventListener("load",(()=>{new lt(ht)}))}},s={};function i(t){var a=s[t];if(void 0!==a)return a.exports;var n=s[t]={exports:{}};return e[t].call(n.exports,n,n.exports,i),n.exports}i.m=e,t=[],i.O=(e,s,a,n)=>{if(!s){var o=1/0;for(c=0;c<t.length;c++){for(var[s,a,n]=t[c],r=!0,h=0;h<s.length;h++)(!1&n||o>=n)&&Object.keys(i.O).every((t=>i.O[t](s[h])))?s.splice(h--,1):(r=!1,n<o&&(o=n));if(r){t.splice(c--,1);var l=a();void 0!==l&&(e=l)}}return e}n=n||0;for(var c=t.length;c>0&&t[c-1][2]>n;c--)t[c]=t[c-1];t[c]=[s,a,n]},i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={179:0};i.O.j=e=>0===t[e];var e=(e,s)=>{var a,n,[o,r,h]=s,l=0;if(o.some((e=>0!==t[e]))){for(a in r)i.o(r,a)&&(i.m[a]=r[a]);if(h)var c=h(i)}for(e&&e(s);l<o.length;l++)n=o[l],i.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return i.O(c)},s=self.webpackChunktype_project_template=self.webpackChunktype_project_template||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))})();var a=i.O(void 0,[216],(()=>i(433)));a=i.O(a)})();