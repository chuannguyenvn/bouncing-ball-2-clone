(()=>{"use strict";var t,e={531:(t,e,s)=>{var i,a=s(260),n=s.n(a);!function(t){t.BOOT="boot-scene",t.LOAD="load-scene",t.PLAY="play-scene",t.SHOP="shop-scene"}(i||(i={}));const o=i,h={BALL_RADIUS:20,BALL_START_POSITION:new(0,Phaser.Math.Vector2)(0,300),BALL_X_VELOCITY:4,PLATFORM_THICKNESS:15,PLATFORM_TINT:7829124,PLATFORM_HIT_MIDDLE_TINT:5635925,PLATFORM_HIT_EDGE_TINT:16742229,GRADIENT_COLUMN_DEFAULT_TINT:13555427,GRADIENT_COLUMN_RANDOM_TINTS:[13891810,14991865,16159937,15591345,11132665],PLATFORM_POOL_SIZE:10,PLATFORM_MIDDLE_PERCENTAGE:.6,HIGH_SCORE_STORAGE_KEY:"high-score",GEMS_COLLECTED_STORAGE_KEY:"gems-collected",SCREENSHAKE_DURATION:100,SCREENSHAKE_STRENGTH:.0075,GEM_SPAWN_CHANCE:.25};var r;!function(t){t.BALL="ball",t.SHOP_BALL="shop-ball",t.SHOP_CEILING="shop-ceiling",t.GEM="gem",t.PLATFORM_PARENT="platform-parent",t.PLATFORM_MIDDLE="platform-middle",t.PLATFORM_SIDE="platform-side"}(r||(r={}));const l=r;var c;!function(t){t[t.INIT=0]="INIT",t[t.MOVING=1]="MOVING",t[t.LOSE=2]="LOSE"}(c||(c={}));const p=c;class d{constructor(t,e,s){this.state=t,this.guid=e,this.callback=s}}const E=class{constructor(t){this.onEntryCallbacks=[],this.onExitCallbacks=[],this._currentState=t}get currentState(){return this._currentState}changeState(t){for(let t=0;t<this.onExitCallbacks.length;t++)this.onExitCallbacks[t].state===this._currentState&&this.onExitCallbacks[t].callback();for(let e=0;e<this.onEntryCallbacks.length;e++)this.onEntryCallbacks[e].state===t&&this.onEntryCallbacks[e].callback();this._currentState=t}configure(t){return this.configuringState=t,this}onEntry(t,e){return this.onEntryCallbacks.push(new d(this.configuringState,t,e)),this}onExit(t,e){return this.onExitCallbacks.push(new d(this.configuringState,t,e)),this}removeAllOf(t){this.onEntryCallbacks.filter((e=>e.guid===t)),this.onExitCallbacks.filter((e=>e.guid===t))}};var S;!function(t){t.SQUARE="square",t.CIRCLE="circle",t.GRADIENT="gradient",t.GEM="gem-sprite",t.BALL_DEFAULT="ball-default",t.BALL_HAPPY="ball-happy",t.BALL_CHIP="ball-chip",t.BALL_LEMON="ball-lemon",t.BALL_YINGYANG="ball-yingyang",t.BUTTON_IDLE="button-idle",t.BUTTON_CLICKED="button-clicked"}(S||(S={}));const u=S;var g;!function(t){t[t.BOOT=0]="BOOT",t[t.LOADING=1]="LOADING",t[t.PLAY=2]="PLAY",t[t.SHOP=3]="SHOP"}(g||(g={}));const m=g;class T{}T.stateMachine=new E(m.BOOT),T.currentSkin=u.BALL_DEFAULT,T.isMute=!1;const L=T;class _{constructor(){this._eventCallbacks=[]}subscribe(t){this._eventCallbacks.push(t)}unsubscribe(t){this._eventCallbacks=this._eventCallbacks.filter((e=>e!==t))}invoke(){for(const t of this._eventCallbacks)t()}}class I{constructor(){this._eventCallbacks=[]}subscribe(t){this._eventCallbacks.push(t)}unsubscribe(t){this._eventCallbacks=this._eventCallbacks.filter((e=>e!==t))}invoke(t){for(const e of this._eventCallbacks)e(t)}}class O extends n().Physics.Matter.Sprite{constructor(t){var e;super(t.matter.world,-300,-100,L.currentSkin),this.hitCenter=new I,this.hitEdge=new _,this.scene.add.existing(this),this.playScene=t,this.type=l.BALL,this.setDisplaySize(2*h.BALL_RADIUS,2*h.BALL_RADIUS),this.setCircle(h.BALL_RADIUS),this.setMass(.01),this.setFriction(0,0,0),this.setStatic(!0),this.playScene.matter.world.on(n().Physics.Matter.Events.COLLISION_START,((t,e,s)=>{if(!s.gameObject||s.gameObject.type!==l.PLATFORM_MIDDLE&&s.gameObject.type!==l.PLATFORM_SIDE)s.gameObject&&s.gameObject.type===l.GEM?(this.playScene.collectedGems++,s.gameObject.platformParent.collectGem(),L.isMute||this.playScene.gemSound.play()):(this.playScene.stateMachine.changeState(p.LOSE),this.playScene.matter.world.setBounds(0,0,0,0));else{this.velocityTween&&this.velocityTween.stop();const t=s.gameObject,e=t.platformParent.index;if(this.playScene.platformSpawner.touchedPlatformIndex.invoke(e),s.gameObject.type===l.PLATFORM_MIDDLE){const e=n().Math.RND.pick(h.GRADIENT_COLUMN_RANDOM_TINTS);this.playScene.addScore(2),this.hitCenter.invoke(e),t.glow(h.PLATFORM_HIT_MIDDLE_TINT)}else this.playScene.addScore(1),this.hitEdge.invoke(),t.glow(h.PLATFORM_HIT_EDGE_TINT);t.platformParent.removeBody(),this.playScene.time.addEvent({delay:5,callback:()=>{this.setVelocity(h.BALL_X_VELOCITY,-8.5),this.setAngularVelocity(.2)}}),L.isMute||n().Math.RND.pick(this.playScene.jumpSounds).play()}})),this.playScene.input.on(n().Input.Events.POINTER_DOWN,(()=>this.thrustDown()));const s=null===(e=this.playScene.input.keyboard)||void 0===e?void 0:e.addKey(n().Input.Keyboard.KeyCodes.SPACE);null==s||s.on(n().Input.Keyboard.Events.DOWN,(()=>this.thrustDown())),this.playScene.stateMachine.configure(p.MOVING).onEntry(-1,(()=>{this.setStatic(!1)})),this.playScene.isWelcomingPlayer?(this.setPosition(h.BALL_START_POSITION.x,h.BALL_START_POSITION.y),this.playScene.allowPlay=!0):this.playScene.tweens.add({targets:[this],x:h.BALL_START_POSITION.x,y:h.BALL_START_POSITION.y,duration:700,delay:1e3,ease:n().Math.Easing.Sine.Out,onComplete:()=>this.playScene.allowPlay=!0})}thrustDown(){this.velocityTween&&this.velocityTween.stop(),this.velocityTween=this.playScene.tweens.addCounter({from:this.getVelocity().y,to:15,ease:"expo.out",duration:600,onUpdate:t=>{this.setVelocityY(t.getValue())}})}}const A=O;var P=n().Display.Color;class y extends n().GameObjects.Text{constructor(t){super(t,0,100,"0",{font:"150px calibri",color:"#eeeeee"}),this.scene.add.existing(this),this.playScene=t,this.setOrigin(.5,0),this.setDepth(-1),this.playScene.scoreChanged.subscribe((t=>this.text=t.toString())),this.playScene.stateMachine.configure(p.MOVING).onEntry(-1,(()=>{this.setX(this.scene.scale.width/2),this.setScrollFactor(0)})),this.playScene.stateMachine.configure(p.MOVING).onExit(-1,(()=>{this.setScrollFactor(1),this.setX(this.scene.cameras.main.scrollX+this.scene.scale.width/2)})),this.playScene.stateMachine.configure(p.LOSE).onEntry(-1,(()=>{this.playScene.tweens.addCounter({from:0,to:100,duration:300,ease:n().Math.Easing.Sine.Out,onUpdate:t=>{const e=n().Display.Color.Interpolate.ColorWithColor(P.IntegerToColor(15658734),P.IntegerToColor(4473924),100,t.getValue());this.setColor(P.ObjectToColor(e).rgba)}})}))}}const C=y;var M=n().Input.Events.GAMEOBJECT_POINTER_OUT,R=n().Input.Events.GAMEOBJECT_POINTER_OVER,D=n().Input.Events.GAMEOBJECT_POINTER_DOWN,G=n().Input.Events.GAMEOBJECT_POINTER_UP;class b extends n().GameObjects.NineSlice{constructor(t,e=u.BUTTON_IDLE,s=u.BUTTON_IDLE,i=u.BUTTON_CLICKED){super(t,0,0,e,0,512,256,128,128),this.scene.add.existing(this),this.on(M,(()=>this.setTexture(e))),s&&this.on(R,(()=>this.setTexture(s))),s&&this.on(G,(()=>this.setTexture(s))),i&&this.on(D,(()=>this.setTexture(i))),this.setInteractive(),this.setScrollFactor(0),this.setTexture(e),this.setSize(1e3,10),this.setScale(.1),this.setTint(h.PLATFORM_TINT),this.text=t.add.text(this.x,this.y,"text"),this.text.setOrigin(.5),this.text.setColor("#ffffff"),this.text.setDepth(1e3),this.text.setScrollFactor(0),this.text.setFont("25px calibri")}setPosition(t,e,s,i){var a;return null===(a=this.text)||void 0===a||a.setPosition(t,e),super.setPosition(t,e,s,i)}setVisible(t){var e;return null===(e=this.text)||void 0===e||e.setVisible(t),super.setVisible(t)}}const N=b;var B=Phaser.Input.Events.GAMEOBJECT_POINTER_UP;const f=class extends N{constructor(t){super(t,u.BUTTON_IDLE,u.BUTTON_IDLE,u.BUTTON_CLICKED),this.playScene=t,this.setPosition(70,40),this.setDepth(100),this.setSize(700,10),this.setScale(.15),this.on(B,(()=>{this.playScene.visitShop()})),this.text.text="Shop"}};var x=n().Display.Color;class w extends n().GameObjects.Rectangle{constructor(t){super(t,-100,-100,t.scale.width+200,t.scale.height+200,16777215),this.scene.add.existing(this),this.playScene=t,this.setOrigin(0),this.setScrollFactor(0),this.setDepth(-100)}flashColor(t){this.playScene.tweens.addCounter({from:0,to:100,duration:200,ease:n().Math.Easing.Sine.InOut,onUpdate:e=>{const s=n().Display.Color.Interpolate.ColorWithColor(x.IntegerToColor(t),x.IntegerToColor(16777215),100,e.getValue());this.setFillStyle(n().Display.Color.GetColor(s.r,s.g,s.b))}})}}const v=w,H=class extends N{constructor(t){super(t),this.setPosition(t.scale.width/2,t.scale.height/2),this.text.text="Restart",this.setDepth(100),this.setSize(700,10),this.setScale(.15),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,(()=>{t.isWelcomingPlayer=!0,L.stateMachine.changeState(m.PLAY)}))}};var U=n().Display.Color;class F extends n().GameObjects.Text{constructor(t){super(t,t.scale.width/2,250,"0",{font:"100px calibri",color:"#eeeeee"}),this.scene.add.existing(this),this.playScene=t,this.setOrigin(.5,0),this.setDepth(-1),this.setVisible(!1),this.setScrollFactor(1),this.playScene.stateMachine.configure(p.LOSE).onEntry(-1,(()=>{this.setVisible(!0),this.setX(this.scene.cameras.main.scrollX+this.scene.scale.width/2),this.text=localStorage.getItem(h.HIGH_SCORE_STORAGE_KEY),this.playScene.tweens.addCounter({from:0,to:100,duration:300,ease:n().Math.Easing.Sine.Out,onUpdate:t=>{const e=n().Display.Color.Interpolate.ColorWithColor(U.IntegerToColor(16777215),U.IntegerToColor(4473924),100,t.getValue());this.setColor(U.ObjectToColor(e).rgba)}})}))}}const k=F;var K;!function(t){t.GEM="gem-sound",t.JUMP_1="jump-1-sound",t.JUMP_2="jump-2-sound",t.JUMP_3="jump-3-sound",t.MASTERPIECE="masterpiece"}(K||(K={}));const j=K;var Y=Phaser.Input.Events.GAMEOBJECT_POINTER_UP;const V=class extends N{constructor(t){super(t,u.BUTTON_IDLE,u.BUTTON_IDLE,u.BUTTON_CLICKED),this.playScene=t,this.setPosition(380,40),this.setDepth(100),this.setSize(700,10),this.setScale(.15),this.on(Y,(()=>{this.playScene.isPressingButton=!0,L.isMute=!L.isMute,this.text.text=L.isMute?"Unmute":"Mute"})),this.text.text=L.isMute?"Unmute":"Mute"}};class J extends n().Physics.Matter.Image{constructor(t,e,s){switch(super(t.matter.world,0,0,u.SQUARE),this.scene.add.existing(this),this.platformParent=e,this.platformChildType=s,s){case W.LEFT:case W.RIGHT:this.type=l.PLATFORM_SIDE;break;case W.MIDDLE:this.type=l.PLATFORM_MIDDLE}this.setPosition(-1e4,0)}setup(t,e,s){switch(this.setTint(h.PLATFORM_TINT),this.platformChildType){case W.LEFT:this.setDisplaySize(s*(1-h.PLATFORM_MIDDLE_PERCENTAGE)/2,h.PLATFORM_THICKNESS),this.setRectangle(s*(1-h.PLATFORM_MIDDLE_PERCENTAGE)/2,h.PLATFORM_THICKNESS,{isStatic:!0}),this.setPosition(t-s*(.5-(1-h.PLATFORM_MIDDLE_PERCENTAGE)/4),e);break;case W.RIGHT:this.setDisplaySize(s*(1-h.PLATFORM_MIDDLE_PERCENTAGE)/2,h.PLATFORM_THICKNESS),this.setRectangle(s*(1-h.PLATFORM_MIDDLE_PERCENTAGE)/2,h.PLATFORM_THICKNESS,{isStatic:!0}),this.setPosition(t+s*(.5-(1-h.PLATFORM_MIDDLE_PERCENTAGE)/4),e);break;case W.MIDDLE:this.setDisplaySize(s*(h.PLATFORM_MIDDLE_PERCENTAGE+.01),h.PLATFORM_THICKNESS),this.setRectangle(s*(h.PLATFORM_MIDDLE_PERCENTAGE+.01),h.PLATFORM_THICKNESS,{isStatic:!0}),this.setPosition(t,e)}}glow(t){this.setTint(t)}}var W;!function(t){t[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT",t[t.MIDDLE=2]="MIDDLE"}(W||(W={}));class z extends n().Physics.Matter.Image{constructor(t,e,s=!0){super(t.matter.world,-100,-100,u.GEM),this.scene.add.existing(this),this.platformParent=e,this.type=l.GEM,this.setDisplaySize(25,25),this.setCircle(10),this.setStatic(s),this.setSensor(s)}}const X=z;class Q extends n().GameObjects.Sprite{constructor(t){super(t,0,0,u.SQUARE),this.scene.add.existing(this),this.playScene=t,this.type=l.PLATFORM_PARENT,this.gradientColumn=t.add.image(0,0,u.GRADIENT),this.gradientColumn.setOrigin(.5,0),this.gradientColumn.setDepth(-1),this.platformLeft=new J(t,this,W.LEFT),this.platformRight=new J(t,this,W.RIGHT),this.platformMiddle=new J(t,this,W.MIDDLE),this.gem=new X(this.playScene,this),this.playScene.ball.hitCenter.subscribe((t=>this.handleBallHitCenter(t))),this.playScene.ball.hitEdge.subscribe((()=>this.handleBallHitEdge())),this.playScene.time.delayedCall(0,(()=>this.setup(this.x,this.y,100))),this.visible=!1}setup(t,e,s){this.gradientColumn.setPosition(t,e),this.gradientColumn.setDisplaySize(s,800-e),this.gradientColumn.setTint(h.GRADIENT_COLUMN_DEFAULT_TINT),this.platformLeft.setup(t,e,s),this.platformRight.setup(t,e,s),this.platformMiddle.setup(t,e,s),Math.random()<h.GEM_SPAWN_CHANCE?this.gem.setPosition(t,e-25):this.gem.setPosition(0,-100)}removeBody(){this.playScene.matter.world.remove(this.platformLeft.body),this.playScene.matter.world.remove(this.platformRight.body),this.playScene.matter.world.remove(this.platformMiddle.body),this.playScene.tweens.add({targets:[this.platformLeft,this.platformMiddle,this.platformRight,this.gradientColumn],y:1200,duration:400,ease:"Linear"})}collectGem(){this.gem.setPosition(0,-100)}handleBallHitCenter(t){this.gradientColumn.setTint(t)}handleBallHitEdge(){this.gradientColumn.setTint(h.GRADIENT_COLUMN_DEFAULT_TINT)}}const q=Q;var Z=n().Math.Vector2,$=n().Input.Events.POINTER_UP;class tt extends n().Scene{constructor(){super({key:o.PLAY}),this.currentScore=-2,this.collectedGems=0,this.isWelcomingPlayer=!0,this.jumpSounds=[],this.startedPlaying=!1,this.isPressingButton=!1,this.allowPlay=!1,L.stateMachine.configure(m.PLAY).onEntry(-1,(()=>{L.sceneManager.start(o.PLAY)})),L.stateMachine.configure(m.PLAY).onExit(-1,(()=>{L.sceneManager.stop(this),this.isWelcomingPlayer=!1}))}create(){var t;this.startedPlaying=!1,this.isPressingButton=!1,this.allowPlay=!1,this.stateMachine=new E(p.INIT),this.scoreChanged=new I,this.currentScore=-2,this.collectedGems=0,this.ball=new A(this),this.platformSpawner=new class{constructor(t){this.touchedPlatformIndex=new I,this.platforms=[],this.currentPlatformIndex=0,this.farthestPlatformXPosition=-1,this.currentWidth=75,this.currentHeight=600,this.playScene=t}placeNextPlatform(){this.currentPlatformIndex=(this.currentPlatformIndex+1)%h.PLATFORM_POOL_SIZE;const t=this.platforms[this.currentPlatformIndex];let e=this.farthestPlatformXPosition+200+Phaser.Math.Between(-50,50);-1===this.farthestPlatformXPosition&&(e=0),t.setup(e,this.currentHeight,this.currentWidth),this.farthestPlatformXPosition=e}easePlatformHeight(){this.playScene.tweens.addCounter({from:this.currentHeight,to:200*Math.random()+400,ease:"Sine.inout",duration:500*(5*Math.random()+10),onUpdate:t=>{this.currentHeight=t.getValue()},onComplete:()=>this.easePlatformHeight()})}}(this),this.scoreText=new C(this),this.highScoreText=new k(this),this.background=new v(this),this.visitShopButton=new f(this),this.restartButton=new H(this),this.restartButton.setVisible(!1),this.muteButton=new V(this),this.matter.world.setBounds(0,0,1e5,this.scale.height+100,64,!1,!1,!1),this.cameras.main.scrollX=-1e3,this.isWelcomingPlayer?(this.cameras.main.startFollow(this.ball,!1,.9,0),this.isWelcomingPlayer=!1):this.cameras.main.startFollow(this.ball,!1,.9,0),this.cameras.main.setBounds(-1e3,0,1e5,0),this.input.on($,(()=>{this.isPressingButton?this.isPressingButton=!1:this.allowPlay&&this.startPlay()}));const e=null===(t=this.input.keyboard)||void 0===t?void 0:t.addKey(n().Input.Keyboard.KeyCodes.SPACE);null==e||e.on(n().Input.Keyboard.Events.DOWN,(()=>{this.isPressingButton?this.isPressingButton=!1:this.allowPlay&&this.startPlay()})),this.stateMachine.configure(p.MOVING).onEntry(-1,(()=>{this.tweens.add({targets:this.cameras.main.followOffset,x:-100,duration:400,ease:"Sine.out"})})),this.stateMachine.configure(p.INIT).onExit(-1,(()=>{this.visitShopButton.setVisible(!1),this.muteButton.setVisible(!1)})),this.stateMachine.configure(p.MOVING).onExit(-1,this.handleLoseEntry.bind(this)),this.stateMachine.configure(p.LOSE).onEntry(-1,(()=>{this.restartButton.setVisible(!0)})),this.stateMachine.configure(p.LOSE).onExit(-1,(()=>{this.restartButton.setVisible(!1)})),this.handleGemsCollected(),this.handleHighScore(),this.jumpSounds.push(this.sound.add(j.JUMP_1)),this.jumpSounds.push(this.sound.add(j.JUMP_2)),this.jumpSounds.push(this.sound.add(j.JUMP_3)),this.gemSound=this.sound.add(j.GEM),this.masterpiece&&this.masterpiece.stop(),this.masterpiece=this.sound.add(j.MASTERPIECE),this.setUpWorld()}addScore(t){this.currentScore+=t,this.cameras.main.shake(h.SCREENSHAKE_DURATION,new Z(0,h.SCREENSHAKE_STRENGTH)),this.scoreChanged.invoke(this.currentScore)}visitShop(){L.stateMachine.changeState(m.SHOP)}handleLoseEntry(){this.cameras.main.stopFollow(),this.handleHighScore(),this.handleGemsCollected(),console.log("Lose")}handleHighScore(){localStorage.getItem(h.HIGH_SCORE_STORAGE_KEY)||localStorage.setItem(h.HIGH_SCORE_STORAGE_KEY,"0");const t=parseInt(localStorage.getItem(h.HIGH_SCORE_STORAGE_KEY));this.currentScore>t&&localStorage.setItem(h.HIGH_SCORE_STORAGE_KEY,this.currentScore.toString()),console.log("Highscore: "+localStorage.getItem(h.HIGH_SCORE_STORAGE_KEY))}handleGemsCollected(){"NaN"===localStorage.getItem(h.GEMS_COLLECTED_STORAGE_KEY)&&localStorage.setItem(h.GEMS_COLLECTED_STORAGE_KEY,"0");const t=parseInt(localStorage.getItem(h.GEMS_COLLECTED_STORAGE_KEY));localStorage.setItem(h.GEMS_COLLECTED_STORAGE_KEY,(t+this.collectedGems).toString()),console.log("Gems collected: "+localStorage.getItem(h.GEMS_COLLECTED_STORAGE_KEY))}startPlay(){this.startedPlaying||(this.stateMachine.changeState(p.MOVING),this.startedPlaying=!0,this.masterpiece.play())}setUpWorld(){const t=this.make.tilemap({key:"masterpiece-map"}).createFromObjects("platforms",{name:"platform",classType:q});console.log(t.length)}}const et=tt,st={[u.SQUARE]:"./assets/images/Square.png",[u.CIRCLE]:"./assets/images/Circle.png",[u.GRADIENT]:"./assets/images/Gradient.png",[u.BALL_DEFAULT]:"./assets/images/Ball_Default.png",[u.BALL_HAPPY]:"./assets/images/Ball_happy.png",[u.BALL_CHIP]:"./assets/images/Ball_chip.png",[u.BALL_LEMON]:"./assets/images/Ball_lemon.png",[u.BALL_YINGYANG]:"./assets/images/Ball_yingyang.png",[u.BUTTON_IDLE]:"./assets/images/Button_idle.png",[u.BUTTON_CLICKED]:"./assets/images/Button_clicked.png",[u.GEM]:"./assets/images/Gem.png",[j.GEM]:"./assets/sounds/Gem.wav",[j.JUMP_1]:"./assets/sounds/Jump_1.wav",[j.JUMP_2]:"./assets/sounds/Jump_2.wav",[j.JUMP_3]:"./assets/sounds/Jump_3.wav",[j.MASTERPIECE]:"./assets/sounds/kiet-tac.wav","masterpiece-map":"./assets/tiled/masterpiece-map.json"},it=class{static preloadSprite(t,e){t.load.image(e,st[e])}static preloadSound(t,e){t.load.audio(e,st[e])}};class at extends a.Scene{constructor(){super({key:o.LOAD}),L.stateMachine.configure(m.LOADING).onEntry(-1,(()=>L.sceneManager.start(o.LOAD)))}preload(){this.title=this.add.text(this.scale.width/2,200,"Bouncing Ball 2"),this.title.setFont("65px calibri"),this.title.setColor("#555555"),this.title.setOrigin(.5),this.loadAssets(),this.showLoadingProgress()}create(){this.exitLoading()}exitLoading(){this.tweens.add({targets:this.ballImage,y:h.BALL_START_POSITION.y,displayHeight:2*h.BALL_RADIUS,displayWidth:2*h.BALL_RADIUS,duration:500,ease:"Sine.inout",onComplete:()=>{L.stateMachine.changeState(m.PLAY),this.ballImage.destroy()}}),this.tweens.add({targets:this.progressBar,alpha:0,duration:200,ease:"Sine.inout",onComplete:()=>{this.progressBar.destroy()}}),this.tweens.add({targets:this.title,y:-100,duration:200,ease:Phaser.Math.Easing.Back.In})}loadAssets(){it.preloadSprite(this,u.SQUARE),it.preloadSprite(this,u.CIRCLE),it.preloadSprite(this,u.GRADIENT),it.preloadSprite(this,u.GEM),it.preloadSprite(this,u.BALL_DEFAULT),it.preloadSprite(this,u.BALL_HAPPY),it.preloadSprite(this,u.BALL_CHIP),it.preloadSprite(this,u.BALL_LEMON),it.preloadSprite(this,u.BALL_YINGYANG),it.preloadSprite(this,u.BUTTON_IDLE),it.preloadSprite(this,u.BUTTON_CLICKED),it.preloadSound(this,j.JUMP_1),it.preloadSound(this,j.JUMP_2),it.preloadSound(this,j.JUMP_3),it.preloadSound(this,j.GEM),it.preloadSound(this,j.MASTERPIECE),this.load.tilemapTiledJSON("masterpiece-map",st["masterpiece-map"]);for(let t=0;t<50;t++)this.load.image("logo"+t,st[u.GEM])}showLoadingProgress(){this.progressBar=this.add.graphics(),this.ballImage=this.add.image(this.scale.width/2,this.scale.height/2,u.BALL_DEFAULT),this.ballImage.scale=.25,this.load.on(Phaser.Loader.Events.PROGRESS,(t=>{this.progressBar.clear(),this.progressBar.fillStyle(3355443,1),this.progressBar.fillRect(this.scale.width/2-30,this.scale.height/2+60,60*t,5),this.ballImage.setRotation(t*Phaser.Math.PI2*2)}))}}const nt=at;class ot extends a.Scene{constructor(){super({key:o.BOOT})}preload(){it.preloadSprite(this,u.BALL_DEFAULT)}create(){this.tweens.setFps(60),L.sceneManager=this.scene,L.stateMachine.configure(m.BOOT).onExit(-1,(()=>L.sceneManager.stop(this))),L.stateMachine.changeState(m.LOADING)}}const ht=ot;var rt=n().Input.Events.GAMEOBJECT_POINTER_UP;class lt extends n().Physics.Matter.Sprite{constructor(t,e,s){super(t.matter.world,100,200,e),this.isPurchased=!1,this.shopScene=t,this.shopScene.add.existing(this),this.spriteKey=e,this.type=l.SHOP_BALL,localStorage.getItem(this.spriteKey)||localStorage.setItem(this.spriteKey,"no"),this.isPurchased="yes"===localStorage.getItem(this.spriteKey),this.price=s,s<0&&(this.isPurchased=!0),this.setDisplaySize(2*h.BALL_RADIUS,2*h.BALL_RADIUS),this.setCircle(h.BALL_RADIUS),this.setStatic(!this.isPurchased),this.isPurchased?this.releaseBall():(this.priceText=this.shopScene.add.text(this.x,this.y+15,this.price.toString()),this.priceText.setOrigin(.5),this.priceText.setFont("20px calibri"),this.priceText.setColor("222222")),this.setInteractive(),this.on(rt,(()=>{!this.isPurchased&&parseInt(localStorage.getItem(h.GEMS_COLLECTED_STORAGE_KEY))>=this.price&&this.purchase()}))}purchase(){this.isPurchased=!0,localStorage.setItem(this.spriteKey,"yes"),this.releaseBall(),this.priceText&&this.priceText.destroy();const t=parseInt(localStorage.getItem(h.GEMS_COLLECTED_STORAGE_KEY))-this.price;localStorage.setItem(h.GEMS_COLLECTED_STORAGE_KEY,t.toString()),this.shopScene.updateGemCount(t)}alignText(){this.isPurchased||this.priceText.setPosition(this.x,this.y+50)}releaseBall(){this.setStatic(!1),this.setVelocity(n().Math.Between(-1,1),n().Math.Between(-3,-5)),this.setAngularVelocity(n().Math.Between(-.1,.1))}}const ct=lt;class pt extends n().Physics.Matter.Image{constructor(t){super(t.matter.world,t.scale.width/2,-200,""),this.shopScene=t,this.shopScene.add.existing(this),this.type=l.SHOP_CEILING,this.setRectangle(this.shopScene.scale.width,100),this.setSensor(!0),this.setStatic(!0)}}const dt=pt;class Et extends n().Scene{constructor(){super({key:o.SHOP}),this.shopItems=[],this.gems=[],L.stateMachine.configure(m.SHOP).onEntry(-1,(()=>L.sceneManager.start(o.SHOP))),L.stateMachine.configure(m.SHOP).onExit(-1,(()=>L.sceneManager.stop(this)))}create(){this.matter.world.setBounds(0,0,this.scale.width,this.scale.height,64,!0,!0,!1,!0),new dt(this),this.shopItems=[],this.gems=[],this.shopItems.push(new ct(this,u.BALL_HAPPY,3)),this.shopItems.push(new ct(this,u.BALL_CHIP,3)),this.shopItems.push(new ct(this,u.BALL_LEMON,3)),this.shopItems.push(new ct(this,u.BALL_YINGYANG,3)),n().Actions.GridAlign(this.shopItems,{width:2,height:2,cellWidth:300,cellHeight:150,x:-50,y:175}),this.shopItems.push(new ct(this,u.BALL_DEFAULT,-1)),this.shopItems.forEach((t=>t.alignText())),this.matter.add.mouseSpring(),this.matter.world.on(n().Physics.Matter.Events.COLLISION_START,((t,e,s)=>{e.gameObject&&s.gameObject&&(e.gameObject.type===l.SHOP_CEILING&&(s.gameObject.type===l.SHOP_BALL||s.gameObject.type===l.GEM)||e.gameObject.type===l.SHOP_CEILING&&(s.gameObject.type===l.SHOP_BALL||s.gameObject.type===l.GEM))&&(e.gameObject.type===l.SHOP_CEILING?s.gameObject instanceof ct?L.currentSkin=s.gameObject.spriteKey:L.currentSkin=u.GEM:e.gameObject instanceof ct?L.currentSkin=e.gameObject.spriteKey:L.currentSkin=u.GEM,this.cameras.main.pan(1e3+this.cameras.main.scrollX,this.scale.height/2,1e3,n().Math.Easing.Sine.InOut,!1,((t,e)=>{1===e&&L.stateMachine.changeState(m.PLAY)})))})),this.gemCountText=this.add.text(this.scale.width/2,this.scale.height/2,localStorage.getItem(h.GEMS_COLLECTED_STORAGE_KEY)),this.gemCountText.setColor("#eeeeee"),this.gemCountText.setFont("100px calibri"),this.gemCountText.setOrigin(.5),this.gemCountText.setDepth(-100);const t=[],e=this.matter.world.nextGroup(!0);let s=0,i=this.matter.add.image(s,600,u.CIRCLE,void 0,{shape:"circle",mass:.1,circleRadius:1});i.setDisplaySize(2*h.BALL_RADIUS,2*h.BALL_RADIUS),i.setTint(11184810),t.push(i),i.setAngularSpeed(n().Math.Between(-.1,.1));for(let a=0;a<10;a++){const a=this.matter.add.image(s,50,u.CIRCLE,void 0,{shape:"circle",mass:.1,circleRadius:1,collisionFilter:{group:e}});t.push(a),this.matter.add.joint(i.body,a.body,35,.8),i=a,i.setDisplaySize(2*h.BALL_RADIUS,2*h.BALL_RADIUS),i.setAngularSpeed(n().Math.Between(-.1,.1)),i.setTint(11184810),s+=30}i.setDisplaySize(2*h.BALL_RADIUS,2*h.BALL_RADIUS),this.matter.add.worldConstraint(t[0].body,2,.9,{pointA:{x:0,y:50},pointB:{x:-25,y:0}}),this.matter.add.worldConstraint(t[t.length-1].body,2,.9,{pointA:{x:this.scale.width,y:50},pointB:{x:25,y:0}});const a=parseInt(localStorage.getItem(h.GEMS_COLLECTED_STORAGE_KEY));for(let t=0;t<a;t++){const t=new X(this,void 0,!1);t.setPosition(n().Math.Between(0,this.scale.width),0),this.gems.push(t)}this.gemCountText.text=a.toString(),this.updateGemCount(parseInt(localStorage.getItem(h.GEMS_COLLECTED_STORAGE_KEY)))}updateGemCount(t){if(isNaN(t))this.gemCountText.text="0";else{this.gemCountText.text=t.toString();for(let e=this.gems.length-1;e>=t;e--)this.gems.pop().destroy()}}}const St=Et,ut={title:"Bouncing Ball 2",width:450,height:800,parent:"game",scale:{mode:n().Scale.FIT,autoCenter:n().Scale.CENTER_BOTH},scene:[ht,nt,et,St],backgroundColor:16777215,physics:{default:"matter",matter:{debug:!0,gravity:{x:0,y:.4}}}};class gt extends n().Game{constructor(t){super(t)}}window.addEventListener("load",(()=>{new gt(ut)}))}},s={};function i(t){var a=s[t];if(void 0!==a)return a.exports;var n=s[t]={exports:{}};return e[t].call(n.exports,n,n.exports,i),n.exports}i.m=e,t=[],i.O=(e,s,a,n)=>{if(!s){var o=1/0;for(c=0;c<t.length;c++){for(var[s,a,n]=t[c],h=!0,r=0;r<s.length;r++)(!1&n||o>=n)&&Object.keys(i.O).every((t=>i.O[t](s[r])))?s.splice(r--,1):(h=!1,n<o&&(o=n));if(h){t.splice(c--,1);var l=a();void 0!==l&&(e=l)}}return e}n=n||0;for(var c=t.length;c>0&&t[c-1][2]>n;c--)t[c]=t[c-1];t[c]=[s,a,n]},i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={179:0};i.O.j=e=>0===t[e];var e=(e,s)=>{var a,n,[o,h,r]=s,l=0;if(o.some((e=>0!==t[e]))){for(a in h)i.o(h,a)&&(i.m[a]=h[a]);if(r)var c=r(i)}for(e&&e(s);l<o.length;l++)n=o[l],i.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return i.O(c)},s=self.webpackChunktype_project_template=self.webpackChunktype_project_template||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))})();var a=i.O(void 0,[216],(()=>i(531)));a=i.O(a)})();